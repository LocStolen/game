<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatGPT 5.2 Instant (Powered by SimSimi SWS API)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap');

        :root {
            --sidebar-bg: #171717;
            --main-bg: #212121;
            --text-main: #ececec;
            --text-secondary: #b4b4b4;
            --input-bg: #2f2f2f;
            --border-color: #3d3d3d;
            --accent-simsimi: #ffc107; /* Màu chủ đạo SimSimi */
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }

        body {
            background-color: var(--main-bg);
            color: var(--text-main);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* SIDEBAR */
        .sidebar {
            width: 260px;
            background-color: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            padding: 12px;
            border-right: 1px solid var(--border-color);
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 4px;
            font-size: 14px;
        }

        .sidebar-item:hover { background-color: #2f2f2f; }
        .sidebar-item i { margin-right: 12px; width: 16px; text-align: center; color: var(--text-secondary); }

        /* MAIN CONTENT */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            align-items: center;
        }

        /* NỘI DUNG CHAT */
        #chat-window {
            flex: 1;
            width: 100%;
            max-width: 800px;
            overflow-y: auto;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            gap: 30px;
            scrollbar-width: none;
        }

        .welcome-screen {
            text-align: center;
            margin-top: 15vh;
        }

        .welcome-screen h1 { font-size: 38px; font-weight: 600; margin-bottom: 40px; }

        /* TIN NHẮN */
        .message { display: flex; gap: 20px; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .avatar {
            width: 32px; height: 32px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 12px;
        }
        .user-msg .avatar { background: #5436da; }
        .ai-msg .avatar { background: var(--accent-simsimi); }

        .content { flex: 1; line-height: 1.6; font-size: 16px; word-wrap: break-word; }

        /* KHUNG NHẬP LIỆU */
        .input-area {
            width: 100%;
            max-width: 760px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .search-box {
            background-color: var(--input-bg);
            border-radius: 28px;
            padding: 10px 18px;
            display: flex;
            align-items: center;
            border: 1px solid var(--border-color);
        }

        .search-box input {
            background: transparent; border: none; outline: none;
            color: white; flex: 1; font-size: 16px; padding: 10px;
        }

        .btn-send {
            width: 36px; height: 36px; border-radius: 50%;
            background: #676767; color: #212121;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.3s;
        }
        .btn-send.active { background: white; cursor: pointer; }

        /* THANH TÁC VỤ GIẢ LẬP */
        .status-bar {
            position: absolute; bottom: 8px; right: 20px;
            font-size: 12px; color: #888; display: flex; gap: 15px;
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <div style="font-weight: 600; padding: 10px 0 20px 10px;">ChatGPT 5.2 Instant <i class="fas fa-chevron-down"></i></div>
        <div class="sidebar-item"><i class="fas fa-plus"></i> Đoạn chat mới</div>
        <div class="sidebar-item"><i class="fas fa-search"></i> Tìm kiếm đoạn chat</div>
        <div class="sidebar-item"><i class="fas fa-th-large"></i> Thư viện</div>
        <div class="sidebar-item"><i class="fas fa-compass"></i> Codex</div>
    </div>

    <div class="main-content">
        <div id="chat-window">
            <div class="welcome-screen" id="welcome-screen">
                <h1>Bạn đang làm về cái gì?</h1>
            </div>
        </div>

        <div class="input-area">
            <div class="search-box">
                <i class="fas fa-plus" style="color: #b4b4b4; margin-right: 10px; cursor: pointer;"></i>
                <input type="text" id="user-input" placeholder="Hỏi bất kỳ điều gì">
                <i class="fas fa-microphone" style="color: #b4b4b4; margin-right: 15px; cursor: pointer;"></i>
                <div class="btn-send" id="send-btn">
                    <i class="fas fa-arrow-up"></i>
                </div>
            </div>
        </div>

        <div class="status-bar">
            <span>30°C Nắng rải rác</span>
            <span>ENG US</span>
            <span>5:13 PM 12/12/2025</span>
        </div>
    </div>

    <script>
        // SIMSIMI API KEY CỦA BẠN ĐÃ ĐƯỢC SỬ DỤNG
        const SIMSIMI_PROJECT_KEY = "fyph-iq3J5uHoJS.4O990N4v-.P0vCMU9DzEdEFx"; 
        
        // SỬ DỤNG ENDPOINT CHÍNH THỨC CỦA SIMSIMI WORKSHOP SERVICES (SWS)
        const SIMSIMI_API_ENDPOINT = "https://wsapi.simsimi.com/190410/talk";
        // 190410 là phiên bản API dùng trong ví dụ tài liệu

        const input = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const chatWindow = document.getElementById('chat-window');
        const welcomeScreen = document.getElementById('welcome-screen');

        input.addEventListener('input', () => {
            sendBtn.classList.toggle('active', input.value.trim() !== "");
        });

        async function callSimSimi(prompt) {
            
            const response = await fetch(SIMSIMI_API_ENDPOINT, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    // Key được đặt trong Header 'x-api-key' như tài liệu yêu cầu
                    "x-api-key": SIMSIMI_PROJECT_KEY 
                },
                body: JSON.stringify({
                    "utext": prompt,
                    "lang": "vn" // Đặt ngôn ngữ là Tiếng Việt
                })
            });

            const data = await response.json();
            
            // Theo tài liệu, câu trả lời nằm trong trường 'atext'
            if (data.status === 200) {
                return data.atext;
            } else if (data.status === 403) {
                 return `Lỗi (403 Unauthorized): Key SimSimi không hợp lệ. Vui lòng kiểm tra lại PROJECT KEY.`;
            } else if (data.status === 429) {
                 return `Lỗi (429 Limit Exceeded): Key SimSimi đã hết hạn mức sử dụng.`;
            } else if (data.statusMessage) {
                // Xử lý các lỗi khác như 227 Parameter Required, 228 Do Not Understand, 500 Server error
                return `Lỗi từ SimSimi (${data.status}): ${data.statusMessage}. Thử lại sau.`;
            } else {
                return "Lỗi không xác định khi nhận phản hồi từ SimSimi.";
            }
        }


        async function handleSend() {
            const text = input.value.trim();
            if (!text) return;

            if (welcomeScreen) welcomeScreen.remove();

            appendMessage('user', text);
            input.value = "";
            sendBtn.classList.remove('active');

            const aiMsgDiv = appendMessage('ai', "Đang trò chuyện với SimSimi...");

            try {
                const aiResponse = await callSimSimi(text); 
                aiMsgDiv.querySelector('.content').innerText = aiResponse;
            } catch (error) {
                // Đây là lỗi kết nối mạng thực sự, hoặc lỗi CORS (nếu chạy local)
                aiMsgDiv.querySelector('.content').innerText = "Lỗi kết nối mạng hoặc lỗi CORS khi gọi SimSimi API. Hãy kiểm tra lại kết nối Internet của bạn hoặc chạy file trên web server.";
            }

            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        function appendMessage(role, text) {
            const msg = document.createElement('div');
            msg.className = `message ${role}-msg`;
            msg.innerHTML = `
                <div class="avatar">${role === 'user' ? 'U' : 'AI'}</div>
                <div class="content">${text}</div>
            `;
            chatWindow.appendChild(msg);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            return msg;
        }

        sendBtn.addEventListener('click', handleSend);
        input.addEventListener('keypress', (e) => { 
            if (e.key === 'Enter') handleSend(); 
        });
    </script>
</body>
</html>
